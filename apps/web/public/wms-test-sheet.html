<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WMS End-to-End Test Sheet</title>
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', system-ui, sans-serif; color: #1a1a1a; padding: 24px; max-width: 900px; margin: 0 auto; }
    h1 { font-size: 24px; margin-bottom: 4px; }
    .subtitle { color: #666; font-size: 14px; margin-bottom: 32px; }
    h2 { font-size: 18px; margin: 32px 0 12px; padding-bottom: 8px; border-bottom: 2px solid #e5e5e5; }
    h3 { font-size: 15px; margin: 20px 0 8px; color: #333; }

    .phase { margin-bottom: 40px; page-break-inside: avoid; }
    .phase-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; padding: 12px 16px; border-radius: 8px; }
    .phase-number { font-size: 20px; font-weight: 700; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; border-radius: 50%; color: white; flex-shrink: 0; }
    .phase-title { font-size: 18px; font-weight: 600; }
    .phase-desc { font-size: 13px; color: #555; margin-top: 2px; }

    .phase-receiving .phase-header { background: #eff6ff; }
    .phase-receiving .phase-number { background: #2563eb; }
    .phase-transfer .phase-header { background: #fefce8; }
    .phase-transfer .phase-number { background: #ca8a04; }
    .phase-pick .phase-header { background: #fdf2f8; }
    .phase-pick .phase-number { background: #db2777; }
    .phase-dispatch .phase-header { background: #f5f3ff; }
    .phase-dispatch .phase-number { background: #7c3aed; }

    .steps { margin-left: 16px; }
    .step { display: flex; gap: 10px; margin-bottom: 10px; align-items: flex-start; }
    .step-num { background: #f3f4f6; color: #374151; font-size: 12px; font-weight: 600; width: 22px; height: 22px; display: flex; align-items: center; justify-content: center; border-radius: 50%; flex-shrink: 0; margin-top: 1px; }
    .step-text { font-size: 14px; line-height: 1.5; }
    .step-text code { background: #f3f4f6; padding: 1px 6px; border-radius: 4px; font-size: 13px; font-family: 'SF Mono', monospace; }
    .step-text .scan { color: #2563eb; font-weight: 600; }
    .step-text .action { color: #16a34a; font-weight: 600; }
    .step-text .check { color: #ca8a04; font-weight: 600; }

    .barcode-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin: 16px 0; }
    .barcode-card { border: 1px solid #e5e5e5; border-radius: 8px; padding: 12px; text-align: center; page-break-inside: avoid; }
    .barcode-card.location { border-color: #93c5fd; background: #f8faff; }
    .barcode-card.case-label { border-color: #86efac; background: #f8fff8; }
    .barcode-label { font-size: 11px; color: #666; margin-bottom: 4px; text-transform: uppercase; letter-spacing: 0.5px; }
    .barcode-value { font-size: 13px; font-weight: 600; font-family: 'SF Mono', monospace; margin-top: 4px; word-break: break-all; }
    .barcode-card svg { max-width: 100%; height: auto; }

    .checklist { margin: 16px 0 16px 16px; }
    .checklist li { font-size: 14px; margin-bottom: 8px; list-style: none; padding-left: 24px; position: relative; }
    .checklist li::before { content: ''; position: absolute; left: 0; top: 4px; width: 14px; height: 14px; border: 2px solid #ccc; border-radius: 3px; }

    .note { background: #fffbeb; border: 1px solid #fbbf24; border-radius: 6px; padding: 10px 14px; font-size: 13px; margin: 12px 0; }
    .note strong { color: #92400e; }
    .note.info { background: #eff6ff; border-color: #93c5fd; }
    .note.info strong { color: #1e40af; }

    .separator { border: none; border-top: 1px dashed #d1d5db; margin: 32px 0; }

    .stock-table { width: 100%; border-collapse: collapse; margin: 12px 0; font-size: 13px; }
    .stock-table th { background: #f3f4f6; text-align: left; padding: 6px 10px; font-weight: 600; border-bottom: 2px solid #e5e5e5; }
    .stock-table td { padding: 6px 10px; border-bottom: 1px solid #e5e5e5; }

    @media print {
      body { padding: 12px; }
      .phase { page-break-inside: avoid; }
      .no-print { display: none; }
      .barcode-grid { gap: 8px; }
    }

    .print-btn { position: fixed; top: 16px; right: 16px; background: #2563eb; color: white; border: none; padding: 10px 20px; border-radius: 6px; font-size: 14px; cursor: pointer; z-index: 100; }
    .print-btn:hover { background: #1d4ed8; }
  </style>
</head>
<body>

<button class="print-btn no-print" onclick="window.print()">Print This Sheet</button>

<h1>WMS End-to-End Flow Test</h1>
<p class="subtitle">Craft &amp; Culture Warehouse &mdash; Generated 14 Feb 2026 from live data</p>

<div class="note info"><strong>How this works:</strong> Each phase is independent &mdash; you can test them in any order. Barcodes below are from real data in the system. The location barcodes work for all phases. Case barcodes are only needed for Transfer.</div>

<!-- ==================== CURRENT STOCK SNAPSHOT ==================== -->

<h2>Current Stock Snapshot</h2>
<p style="font-size:13px;color:#666;margin-bottom:8px;">What's actually in the warehouse right now. Use this to verify your test results.</p>

<table class="stock-table">
  <thead>
    <tr><th>Product</th><th>Location</th><th>Cases</th><th>Owner</th></tr>
  </thead>
  <tbody>
    <tr><td>Francois Thienpont Terre Blaye 2021</td><td>A-01-04</td><td>68</td><td>CRURATED</td></tr>
    <tr><td>Alain Ducrot Crustated 1999</td><td>A-01-04</td><td>58</td><td>CRURATED</td></tr>
    <tr><td>Chateau FONTENIL 2018</td><td>A-01-00</td><td>27</td><td>Exception</td></tr>
    <tr><td>LE BLANC DE FONTENIL 2020</td><td>A-01-01</td><td>14</td><td>Exception</td></tr>
    <tr><td>Barolo DOCG Pravo 2019</td><td>A-01-03</td><td>9</td><td>CRURATED</td></tr>
    <tr><td>Champagne Les Revenants 2020</td><td>A-01-04</td><td>8</td><td>CRURATED</td></tr>
    <tr><td>MARIFLOR MALBEC 2022</td><td>A-01-02</td><td>8</td><td>Exception</td></tr>
    <tr><td>Echezeaux Grand Cru</td><td>A-01-00</td><td>2</td><td>Craft &amp; Culture</td></tr>
    <tr><td>Pouilly Fume, Ladoucette 2022</td><td>A-01-02</td><td>3</td><td>Cult Wines</td></tr>
    <tr><td>Dom Perignon (2x)</td><td>A-01-01</td><td>3</td><td>Craft &amp; Culture</td></tr>
  </tbody>
</table>

<hr class="separator">

<!-- ==================== BARCODE REFERENCE ==================== -->

<h2>Scannable Barcodes</h2>
<p style="font-size:13px;color:#666;margin-bottom:16px;">Print this page and scan with TC27. All barcodes match real records in the system.</p>

<h3>Location Barcodes (use for all phases)</h3>
<div class="barcode-grid">
  <div class="barcode-card location">
    <div class="barcode-label">Receiving Dock</div>
    <svg id="bc-loc-inbound"></svg>
    <div class="barcode-value">LOC-GOODS INBOUND</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Shipping Dock</div>
    <svg id="bc-loc-shipping"></svg>
    <div class="barcode-value">LOC-SHIPPING</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-01-00 (has stock)</div>
    <svg id="bc-loc-a01-00"></svg>
    <div class="barcode-value">LOC-A-01-00</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-01-01 (has stock)</div>
    <svg id="bc-loc-a01-01"></svg>
    <div class="barcode-value">LOC-A-01-01</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-01-03 (Barolo, 9 cases)</div>
    <svg id="bc-loc-a01-03"></svg>
    <div class="barcode-value">LOC-A-01-03</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-02-01 (empty)</div>
    <svg id="bc-loc-a02-01"></svg>
    <div class="barcode-value">LOC-A-02-01</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-03-01 (empty)</div>
    <svg id="bc-loc-a03-01"></svg>
    <div class="barcode-value">LOC-A-03-01</div>
  </div>
  <div class="barcode-card location">
    <div class="barcode-label">Rack A-01-04 (126 cases)</div>
    <svg id="bc-loc-a01-04"></svg>
    <div class="barcode-value">LOC-A-01-04</div>
  </div>
</div>

<h3>Case Barcodes &mdash; Barolo DOCG (at A-01-03)</h3>
<div class="barcode-grid">
  <div class="barcode-card case-label">
    <div class="barcode-label">Barolo Case #2</div>
    <svg id="bc-case-1"></svg>
    <div class="barcode-value">CASE-2133208-0000-03-00750-002</div>
  </div>
  <div class="barcode-card case-label">
    <div class="barcode-label">Barolo Case #3</div>
    <svg id="bc-case-2"></svg>
    <div class="barcode-value">CASE-2133208-0000-03-00750-003</div>
  </div>
  <div class="barcode-card case-label">
    <div class="barcode-label">Barolo Case #4</div>
    <svg id="bc-case-3"></svg>
    <div class="barcode-value">CASE-2133208-0000-03-00750-004</div>
  </div>
  <div class="barcode-card case-label">
    <div class="barcode-label">Barolo Case #5</div>
    <svg id="bc-case-4"></svg>
    <div class="barcode-value">CASE-2133208-0000-03-00750-005</div>
  </div>
</div>

<h3>Case Barcodes &mdash; Echezeaux Grand Cru (at A-01-00)</h3>
<div class="barcode-grid">
  <div class="barcode-card case-label">
    <div class="barcode-label">Echezeaux Case #2</div>
    <svg id="bc-case-ech-1"></svg>
    <div class="barcode-value">CASE-102005620200600750-002</div>
  </div>
  <div class="barcode-card case-label">
    <div class="barcode-label">Echezeaux Case #3</div>
    <svg id="bc-case-ech-2"></svg>
    <div class="barcode-value">CASE-102005620200600750-003</div>
  </div>
</div>

<h3>Case Barcodes &mdash; Alain Ducrot Crustated (at A-01-04)</h3>
<div class="barcode-grid">
  <div class="barcode-card case-label">
    <div class="barcode-label">Ducrot Case #51</div>
    <svg id="bc-case-duc-1"></svg>
    <div class="barcode-value">CASE-1789074-0000-01-00700-051</div>
  </div>
  <div class="barcode-card case-label">
    <div class="barcode-label">Ducrot Case #52</div>
    <svg id="bc-case-duc-2"></svg>
    <div class="barcode-value">CASE-1789074-0000-01-00700-052</div>
  </div>
</div>

<hr class="separator">

<!-- ==================== PHASE 1: RECEIVING ==================== -->

<div class="phase phase-receiving">
  <div class="phase-header">
    <div class="phase-number">1</div>
    <div>
      <div class="phase-title">Receiving</div>
      <div class="phase-desc">Unload pallet, verify count, scan destination bay, print labels, shelve directly</div>
    </div>
  </div>

  <div class="note info"><strong>Available shipments:</strong> SHP-2026-0003 (Cult Wines) and HB-2026-0014 &mdash; both at "at_warehouse" status, ready to receive. You scan a rack barcode to shelve directly &mdash; no need to stage at GOODS INBOUND first.</div>

  <div class="steps">
    <div class="step"><div class="step-num">1</div><div class="step-text"><span class="action">Navigate</span> to <code>/platform/admin/wms/receiving</code></div></div>
    <div class="step"><div class="step-num">2</div><div class="step-text"><span class="action">Select</span> shipment <code>SHP-2026-0003</code> or <code>HB-2026-0014</code></div></div>
    <div class="step"><div class="step-num">3</div><div class="step-text">For each product in the shipment:</div></div>
    <div class="step"><div class="step-num">3a</div><div class="step-text"><span class="action">Verify</span> case count &mdash; enter how many cases you actually received</div></div>
    <div class="step"><div class="step-num">3b</div><div class="step-text"><span class="scan">Scan destination bay</span> barcode (e.g. <code>LOC-A-02-01</code>) &mdash; this is where the cases go on the shelf</div></div>
    <div class="step"><div class="step-num">3c</div><div class="step-text"><span class="action">Print labels</span> &mdash; case labels print for that bay</div></div>
    <div class="step"><div class="step-num">3d</div><div class="step-text"><span class="action">Confirm &amp; Save</span> &mdash; stock created at the scanned bay</div></div>
    <div class="step"><div class="step-num">4</div><div class="step-text">Repeat step 3 for each product (different products can go to different bays)</div></div>
    <div class="step"><div class="step-num">5</div><div class="step-text"><span class="action">Finalize</span> &mdash; shipment marked as delivered</div></div>
  </div>

  <ul class="checklist">
    <li>Stock rows created directly at scanned rack locations (not GOODS INBOUND)</li>
    <li>Case labels printed with correct bay assignment</li>
    <li>Movement records with type "receive"</li>
    <li>Shipment status changed to "delivered"</li>
  </ul>

  <div class="note"><strong>If both shipments are already received:</strong> There's nothing to receive. Skip to Phase 2 &mdash; the other phases work independently.</div>
</div>

<!-- ==================== PHASE 2: TRANSFER ==================== -->

<div class="phase phase-transfer">
  <div class="phase-header">
    <div class="phase-number">2</div>
    <div>
      <div class="phase-title">Transfer</div>
      <div class="phase-desc">Move existing stock between rack locations (reorganise shelves, consolidate, etc.)</div>
    </div>
  </div>

  <div class="note info"><strong>For reorganising existing stock.</strong> Scan a source location to see what's there, select quantity, then scan a destination rack. This is separate from receiving &mdash; use it to move stock between shelves, consolidate, or clear a bay.</div>

  <h3>Test A: Bulk transfer by location scan</h3>
  <div class="steps">
    <div class="step"><div class="step-num">1</div><div class="step-text"><span class="action">Navigate</span> to <code>/platform/admin/wms/transfer</code></div></div>
    <div class="step"><div class="step-num">2</div><div class="step-text"><span class="scan">Scan source</span> <code>LOC-A-01-03</code> (has 9 cases Barolo)</div></div>
    <div class="step"><div class="step-num">3</div><div class="step-text"><span class="check">Verify:</span> Stock list shows Barolo DOCG Pravo 2019</div></div>
    <div class="step"><div class="step-num">4</div><div class="step-text"><span class="action">Select</span> Barolo, set quantity to <code>2</code></div></div>
    <div class="step"><div class="step-num">5</div><div class="step-text"><span class="scan">Scan destination</span> <code>LOC-A-02-01</code> (empty rack)</div></div>
    <div class="step"><div class="step-num">6</div><div class="step-text"><span class="action">Confirm</span> the transfer</div></div>
  </div>

  <h3>Test B: Transfer to another empty rack</h3>
  <div class="steps">
    <div class="step"><div class="step-num">1</div><div class="step-text"><span class="scan">Scan source</span> <code>LOC-A-01-00</code> (has Echezeaux + Fontenil)</div></div>
    <div class="step"><div class="step-num">2</div><div class="step-text"><span class="action">Select</span> Echezeaux, quantity <code>1</code></div></div>
    <div class="step"><div class="step-num">3</div><div class="step-text"><span class="scan">Scan destination</span> <code>LOC-A-03-01</code></div></div>
    <div class="step"><div class="step-num">4</div><div class="step-text"><span class="action">Confirm</span></div></div>
  </div>

  <ul class="checklist">
    <li>A-01-03 Barolo decreased from 9 to 7</li>
    <li>A-02-01 now shows 2 cases Barolo</li>
    <li>A-01-00 Echezeaux decreased by 1</li>
    <li>A-03-01 now shows 1 case Echezeaux</li>
    <li>Movement records with type "transfer"</li>
  </ul>
</div>

<!-- ==================== PHASE 3: PICKING ==================== -->

<div class="phase phase-pick">
  <div class="phase-header">
    <div class="phase-number">3</div>
    <div>
      <div class="phase-title">Pick List</div>
      <div class="phase-desc">Create and execute a pick list from Zoho orders</div>
    </div>
  </div>

  <div class="note"><strong>Pre-req:</strong> Zoho orders must be <em>approved</em> before they appear in pick list creation. Go to <code>/platform/admin/zoho-sales-orders</code> first and approve at least one order (e.g. SO-00064 Super Cellar, or SO-00066 C D General Trading). Currently all orders are in "synced" status.</div>

  <div class="steps">
    <div class="step"><div class="step-num">1</div><div class="step-text"><span class="action">First:</span> Go to <code>/platform/admin/zoho-sales-orders</code> and <span class="action">approve</span> 1-2 orders</div></div>
    <div class="step"><div class="step-num">2</div><div class="step-text"><span class="action">Navigate</span> to <code>/platform/admin/wms/pick/new</code></div></div>
    <div class="step"><div class="step-num">3</div><div class="step-text"><span class="action">Select</span> the approved orders from the Zoho tab</div></div>
    <div class="step"><div class="step-num">4</div><div class="step-text"><span class="action">Create</span> pick list</div></div>
    <div class="step"><div class="step-num">5</div><div class="step-text"><span class="action">Open</span> the pick list detail page</div></div>
    <div class="step"><div class="step-num">6</div><div class="step-text">For each item: <span class="scan">Scan location</span> barcode from this sheet, then <span class="action">mark picked</span></div></div>
    <div class="step"><div class="step-num">7</div><div class="step-text"><span class="action">Complete</span> the pick list when all items are picked</div></div>
  </div>

  <div class="note info"><strong>Available Zoho orders (all synced, need approval):</strong><br>
    SO-00064 &mdash; Super Cellar General Trading<br>
    SO-00066, SO-00067, SO-00065 &mdash; C D General Trading<br>
    SO-00001 &mdash; Peninsula Drinks &amp; Food<br>
    SO-00002, SO-00003 &mdash; Maritime &amp; Mercantile International
  </div>

  <ul class="checklist">
    <li>Pick list created with correct items and suggested locations</li>
    <li>Location scan validates the picker is at the right rack</li>
    <li>Stock quantities decrease after picking</li>
    <li>Pick list status moves to "completed"</li>
  </ul>
</div>

<!-- ==================== PHASE 4: DISPATCH ==================== -->

<div class="phase phase-dispatch">
  <div class="phase-header">
    <div class="phase-number">4</div>
    <div>
      <div class="phase-title">Dispatch</div>
      <div class="phase-desc">Create a dispatch batch, delivery note, and pallet label</div>
    </div>
  </div>

  <div class="note"><strong>Pre-req:</strong> You need picked orders from Phase 3, OR you can test dispatch independently by using any available orders from the dispatch wizard.</div>

  <div class="steps">
    <div class="step"><div class="step-num">1</div><div class="step-text"><span class="action">Navigate</span> to <code>/platform/admin/wms/dispatch/new</code></div></div>
    <div class="step"><div class="step-num">2</div><div class="step-text"><span class="action">Select distributor</span> from dropdown</div></div>
    <div class="step"><div class="step-num">3</div><div class="step-text"><span class="action">Select orders</span> to dispatch (Zoho tab and/or PCO tab)</div></div>
    <div class="step"><div class="step-num">4</div><div class="step-text"><span class="action">Add notes</span> e.g. "Test dispatch #1"</div></div>
    <div class="step"><div class="step-num">5</div><div class="step-text"><span class="action">Click</span> "Dispatch" to create the batch</div></div>
    <div class="step"><div class="step-num">6</div><div class="step-text"><span class="check">Verify:</span> Batch detail page loads with orders and case count</div></div>
    <div class="step"><div class="step-num">7</div><div class="step-text"><span class="action">Click</span> "Print Pallet Label" &mdash; verify ZPL content</div></div>
    <div class="step"><div class="step-num">8</div><div class="step-text"><span class="action">Download</span> delivery note PDF &mdash; verify it has all orders listed</div></div>
  </div>

  <ul class="checklist">
    <li>Batch created with BATCH-2026-XXXX number</li>
    <li>Delivery note PDF has correct distributor, orders, case counts</li>
    <li>Pallet label shows distributor name, batch number, order list</li>
    <li>Order statuses updated (Zoho: dispatched, PCO: stock_in_transit)</li>
  </ul>
</div>

<hr class="separator">

<!-- ==================== VERIFICATION ==================== -->

<h2>Post-Test Verification</h2>
<p style="font-size:14px;margin-bottom:16px;">After testing, check these pages to confirm everything is consistent:</p>

<div class="steps">
  <div class="step"><div class="step-num">1</div><div class="step-text"><span class="action">Stock Overview</span> <code>/platform/admin/wms/stock</code> &mdash; totals should match movements</div></div>
  <div class="step"><div class="step-num">2</div><div class="step-text"><span class="action">Movements</span> <code>/platform/admin/wms/movements</code> &mdash; should see receive, transfer, pick entries</div></div>
  <div class="step"><div class="step-num">3</div><div class="step-text"><span class="action">Location Detail</span> &mdash; click on rack locations to verify received and transferred cases</div></div>
  <div class="step"><div class="step-num">4</div><div class="step-text"><span class="action">Dispatch List</span> <code>/platform/admin/wms/dispatch</code> &mdash; new batch visible</div></div>
</div>

<script>
  const barcodeOpts = { format: 'CODE128', width: 1.5, height: 50, fontSize: 11, margin: 4, displayValue: false };
  const caseOpts = { ...barcodeOpts, width: 1.1 };

  // Location barcodes
  JsBarcode('#bc-loc-inbound', 'LOC-GOODS INBOUND', { ...barcodeOpts, height: 45 });
  JsBarcode('#bc-loc-shipping', 'LOC-SHIPPING', barcodeOpts);
  JsBarcode('#bc-loc-a01-00', 'LOC-A-01-00', barcodeOpts);
  JsBarcode('#bc-loc-a01-01', 'LOC-A-01-01', barcodeOpts);
  JsBarcode('#bc-loc-a01-03', 'LOC-A-01-03', barcodeOpts);
  JsBarcode('#bc-loc-a02-01', 'LOC-A-02-01', barcodeOpts);
  JsBarcode('#bc-loc-a03-01', 'LOC-A-03-01', barcodeOpts);
  JsBarcode('#bc-loc-a01-04', 'LOC-A-01-04', barcodeOpts);

  // Case barcodes - Barolo (at A-01-03)
  JsBarcode('#bc-case-1', 'CASE-2133208-0000-03-00750-002', caseOpts);
  JsBarcode('#bc-case-2', 'CASE-2133208-0000-03-00750-003', caseOpts);
  JsBarcode('#bc-case-3', 'CASE-2133208-0000-03-00750-004', caseOpts);
  JsBarcode('#bc-case-4', 'CASE-2133208-0000-03-00750-005', caseOpts);

  // Case barcodes - Echezeaux (at A-01-00)
  JsBarcode('#bc-case-ech-1', 'CASE-102005620200600750-002', caseOpts);
  JsBarcode('#bc-case-ech-2', 'CASE-102005620200600750-003', caseOpts);

  // Case barcodes - Alain Ducrot (at A-01-04)
  JsBarcode('#bc-case-duc-1', 'CASE-1789074-0000-01-00700-051', caseOpts);
  JsBarcode('#bc-case-duc-2', 'CASE-1789074-0000-01-00700-052', caseOpts);
</script>

</body>
</html>
